#!/usr/bin/env python3\n\"\"\"JavaScript Functionality Tester\nThis script creates a test page to verify all JavaScript functionality works.\"\"\"\n\nimport sys\nsys.path.append('/home/KALPESH/Stuffs/Project Management')\n\nfrom app import create_app\nfrom flask import render_template_string\n\n# Create a comprehensive test HTML page\ntest_html = '''\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>JavaScript Functionality Test - ProjectFlow</title>\n    <link rel=\"stylesheet\" href=\"{{ url_for('static', filename='css/webify-theme.css') }}\">\n    <script src=\"{{ url_for('static', filename='js/core-ui.js') }}\"></script>\n    <script src=\"{{ url_for('static', filename='js/lucide.min.js') }}\"></script>\n    <style>\n        .test-container { max-width: 800px; margin: 20px auto; padding: 20px; }\n        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }\n        .test-result { margin: 10px 0; padding: 10px; border-radius: 3px; }\n        .success { background: #d4edda; color: #155724; }\n        .error { background: #f8d7da; color: #721c24; }\n        button { margin: 5px; padding: 10px 15px; }\n        select, input { margin: 5px; padding: 8px; }\n        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; }\n        .modal-content { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 20px; border-radius: 5px; max-width: 400px; }\n    </style>\n</head>\n<body>\n    <div class=\"test-container\">\n        <h1>JavaScript Functionality Test</h1>\n        <div id=\"testResults\"></div>\n        \n        <!-- Test 1: Basic JavaScript -->\n        <div class=\"test-section\">\n            <h3>Test 1: Basic JavaScript Loading</h3>\n            <button onclick=\"testBasicJS()\">Test Basic JS</button>\n            <div id=\"basicJSResult\"></div>\n        </div>\n        \n        <!-- Test 2: Modal Functionality -->\n        <div class=\"test-section\">\n            <h3>Test 2: Modal Functionality</h3>\n            <button onclick=\"testModal()\">Open Test Modal</button>\n            <div id=\"modalResult\"></div>\n        </div>\n        \n        <!-- Test 3: Form Handling -->\n        <div class=\"test-section\">\n            <h3>Test 3: Form Validation</h3>\n            <form id=\"testForm\" onsubmit=\"return testFormValidation(event)\">\n                <input type=\"text\" name=\"title\" placeholder=\"Title (required)\" required>\n                <select name=\"type\">\n                    <option value=\"\">Select Type</option>\n                    <option value=\"task\">Task</option>\n                    <option value=\"bug\">Bug</option>\n                </select>\n                <button type=\"submit\">Test Form</button>\n            </form>\n            <div id=\"formResult\"></div>\n        </div>\n        \n        <!-- Test 4: Dropdown Functionality -->\n        <div class=\"test-section\">\n            <h3>Test 4: Dropdown Interactions</h3>\n            <select id=\"testDropdown\" onchange=\"testDropdown()\">\n                <option value=\"\">Choose option...</option>\n                <option value=\"option1\">Option 1</option>\n                <option value=\"option2\">Option 2</option>\n            </select>\n            <div id=\"dropdownResult\"></div>\n        </div>\n        \n        <!-- Test 5: AJAX/API Calls -->\n        <div class=\"test-section\">\n            <h3>Test 5: API Connectivity</h3>\n            <button onclick=\"testAPI()\">Test API Call</button>\n            <div id=\"apiResult\"></div>\n        </div>\n        \n        <!-- Test 6: CSS/Icons Loading -->\n        <div class=\"test-section\">\n            <h3>Test 6: Icons and CSS</h3>\n            <i data-lucide=\"check-circle\" style=\"width: 24px; height: 24px; color: green;\"></i>\n            <i data-lucide=\"x-circle\" style=\"width: 24px; height: 24px; color: red;\"></i>\n            <div id=\"iconsResult\"></div>\n        </div>\n    </div>\n    \n    <!-- Test Modal -->\n    <div id=\"testModal\" class=\"modal\">\n        <div class=\"modal-content\">\n            <h3>Test Modal</h3>\n            <p>This is a test modal to verify modal functionality works.</p>\n            <button onclick=\"closeTestModal()\">Close Modal</button>\n        </div>\n    </div>\n    \n    <script>\n        let testResults = [];\n        \n        function showResult(testName, success, message) {\n            const resultDiv = document.getElementById(testName + 'Result');\n            resultDiv.className = 'test-result ' + (success ? 'success' : 'error');\n            resultDiv.innerHTML = `<strong>${success ? '‚úÖ PASS' : '‚ùå FAIL'}:</strong> ${message}`;\n            testResults.push({test: testName, success, message});\n            updateSummary();\n        }\n        \n        function updateSummary() {\n            const summaryDiv = document.getElementById('testResults');\n            const passed = testResults.filter(r => r.success).length;\n            const total = testResults.length;\n            summaryDiv.innerHTML = `<h2>Test Results: ${passed}/${total} Passed</h2>`;\n        }\n        \n        function testBasicJS() {\n            try {\n                if (typeof window.uiController !== 'undefined') {\n                    showResult('basicJS', true, 'Core UI Controller loaded successfully');\n                } else {\n                    showResult('basicJS', false, 'Core UI Controller not found');\n                }\n            } catch (e) {\n                showResult('basicJS', false, 'JavaScript error: ' + e.message);\n            }\n        }\n        \n        function testModal() {\n            try {\n                const modal = document.getElementById('testModal');\n                if (modal) {\n                    modal.style.display = 'block';\n                    showResult('modal', true, 'Modal opened successfully');\n                } else {\n                    showResult('modal', false, 'Modal element not found');\n                }\n            } catch (e) {\n                showResult('modal', false, 'Modal error: ' + e.message);\n            }\n        }\n        \n        function closeTestModal() {\n            document.getElementById('testModal').style.display = 'none';\n        }\n        \n        function testFormValidation(event) {\n            event.preventDefault();\n            try {\n                const form = event.target;\n                const title = form.title.value;\n                if (title.trim()) {\n                    showResult('form', true, 'Form validation working - title: ' + title);\n                } else {\n                    showResult('form', false, 'Form validation failed - empty title');\n                }\n            } catch (e) {\n                showResult('form', false, 'Form error: ' + e.message);\n            }\n            return false;\n        }\n        \n        function testDropdown() {\n            try {\n                const dropdown = document.getElementById('testDropdown');\n                if (dropdown.value) {\n                    showResult('dropdown', true, 'Dropdown working - selected: ' + dropdown.value);\n                } else {\n                    showResult('dropdown', false, 'Dropdown not working - no value selected');\n                }\n            } catch (e) {\n                showResult('dropdown', false, 'Dropdown error: ' + e.message);\n            }\n        }\n        \n        function testAPI() {\n            try {\n                fetch('/api/v1/projects')\n                    .then(response => {\n                        if (response.ok) {\n                            showResult('api', true, 'API call successful - status: ' + response.status);\n                        } else {\n                            showResult('api', false, 'API call failed - status: ' + response.status);\n                        }\n                    })\n                    .catch(error => {\n                        showResult('api', false, 'API error: ' + error.message);\n                    });\n            } catch (e) {\n                showResult('api', false, 'API test error: ' + e.message);\n            }\n        }\n        \n        // Test icons loading\n        document.addEventListener('DOMContentLoaded', function() {\n            setTimeout(() => {\n                const icons = document.querySelectorAll('[data-lucide]');\n                if (icons.length > 0) {\n                    const hasRendered = Array.from(icons).some(icon => icon.innerHTML.includes('svg'));\n                    if (hasRendered) {\n                        showResult('icons', true, 'Lucide icons loaded and rendered');\n                    } else {\n                        showResult('icons', false, 'Lucide icons not rendered');\n                    }\n                } else {\n                    showResult('icons', false, 'No Lucide icons found');\n                }\n            }, 2000);\n            \n            // Auto-run basic tests\n            setTimeout(() => {\n                testBasicJS();\n            }, 1000);\n        });\n    </script>\n</body>\n</html>\n'''\n\napp = create_app()\n\n@app.route('/test-js')\ndef test_js():\n    return render_template_string(test_html)\n\nif __name__ == '__main__':\n    print(\"\\nüß™ JavaScript Test Page Created!\")\n    print(\"\\nüìã To test JavaScript functionality:\")\n    print(\"   1. Start the Flask app: python app.py\")\n    print(\"   2. Visit: http://127.0.0.1:5000/test-js\")\n    print(\"   3. Click test buttons to verify each function\")\n    print(\"\\n‚úÖ This will show you exactly which JS features are broken\")\n    \n    app.run(debug=True, host='127.0.0.1', port=5001)  # Different port to avoid conflicts